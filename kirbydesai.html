<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Interactive Kirby–Desai Scale – Laser Tattoo Removal</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#121821; --muted:#90a3b9; --text:#e7eef7; --accent:#7dd3fc; --accent2:#a7f3d0; --warn:#fcd34d; --bad:#fca5a5;
      --ring: 0 0 0 2px var(--accent);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; background:linear-gradient(180deg, #0b0f14, #0e1520 35%, #101926); color:var(--text); -webkit-tap-highlight-color:transparent;}
    header{padding:20px 16px 10px; text-align:center}
    header h1{margin:0 0 4px; font-size:clamp(1.2rem, 1rem + 3vw, 1.8rem); letter-spacing:.2px; line-height:1.3}
    header p{margin:0; color:var(--muted); font-size:.95rem}
    main{max-width:1100px; margin:16px auto 32px; padding:0 12px; display:grid; grid-template-columns: 1fr; gap:16px}
    @media(min-width: 900px){ main{grid-template-columns: 2fr 1fr;} }

    .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); border-radius:14px; box-shadow: 0 6px 18px rgba(0,0,0,.35);}
    .card h2{margin:0; padding:14px 14px 0; font-size:1rem}
    .content{padding:12px 14px 14px;}
    fieldset{border:0; padding:0; margin:0}
    .group{margin:12px 0 14px; padding:10px; border-radius:12px; background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.06)}
    .group legend, .group h3{font-size:.95rem; margin:0 0 6px;}
    .hint{color:var(--muted); font-size:.85rem; margin-top:4px; line-height:1.3}
    .options{display:grid; gap:8px; grid-template-columns:1fr}
    @media(min-width:600px){ .options{grid-template-columns:1fr 1fr;}}

    label.opt{display:flex; align-items:center; gap:8px; padding:8px 10px; border-radius:10px; border:1px solid rgba(255,255,255,.08); background:rgba(0,0,0,.08); cursor:pointer; font-size:.9rem; line-height:1.3}
    label.opt:hover{border-color:rgba(255,255,255,.18)}
    label.opt input{accent-color:#38bdf8; width:18px; height:18px; flex-shrink:0}
    .points{margin-left:auto; padding:2px 6px; border-radius:999px; font-size:.78rem; background:rgba(125,211,252,.12); color:var(--accent)}

    select, button, input[type="number"]{background:#0f1722; color:var(--text); border:1px solid rgba(255,255,255,.12); border-radius:10px; padding:9px 11px; font:inherit; font-size:.9rem}
    select:focus, button:focus{outline:none; box-shadow:var(--ring)}

    .score{display:grid; gap:14px; padding:14px}
    .pill{display:flex; flex-direction:column; gap:6px; background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:10px}
    .big{font-size:1.6rem; font-weight:700}
    .grid2{display:grid; grid-template-columns:1fr; gap:10px}
    @media(min-width:400px){.grid2{grid-template-columns:1fr 1fr;}}
    .badge{padding:3px 7px; border-radius:999px; font-size:.8rem; border:1px solid rgba(255,255,255,.12); align-self:flex-start}
    .good{background:rgba(167,243,208,.12); color:var(--accent2)}
    .warn{background:rgba(252,211,77,.12); color:var(--warn)}
    .bad{background:rgba(252,165,165,.12); color:var(--bad)}

    .footer{color:var(--muted); font-size:.8rem; padding:12px 14px 14px; line-height:1.4}
    .toolbar{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; padding:0 14px 14px}
    button{cursor:pointer}
    .ghost{background:transparent}
    .ghost:hover{background:rgba(255,255,255,.04)}

    details{border:1px dashed rgba(255,255,255,.14); padding:8px 10px; border-radius:10px; font-size:.9rem}
    details>summary{cursor:pointer; color:var(--accent); font-size:.9rem}
    small{color:var(--muted)}
    a{color:var(--accent)}
  </style>
</head>
<body>
  <header>
    <h1>Kirby–Desai Scale</h1>
    <p>An interactive guide to estimate laser tattoo‑removal sessions (each point ≈ one session).</p>
  </header>

  <main>
    <section class="card" aria-labelledby="inputs-heading">
      <h2 id="inputs-heading">Tattoo characteristics</h2>
      <div class="content" id="form">
        <fieldset class="group" aria-labelledby="skin-legend">
          <legend id="skin-legend">Fitzpatrick skin type</legend>
          <p class="hint">Higher type → more points</p>
          <div class="options" id="skin"></div>
        </fieldset>
        <fieldset class="group" aria-labelledby="loc-legend">
          <legend id="loc-legend">Tattoo location</legend>
          <div class="options" id="location"></div>
        </fieldset>
        <fieldset class="group" aria-labelledby="color-legend">
          <legend id="color-legend">Pigment colors</legend>
          <div class="options" id="colors"></div>
        </fieldset>
        <fieldset class="group" aria-labelledby="ink-legend">
          <legend id="ink-legend">Amount of ink</legend>
          <div class="options" id="ink"></div>
        </fieldset>
        <fieldset class="group" aria-labelledby="scar-legend">
          <legend id="scar-legend">Scarring / tissue change</legend>
          <div class="options" id="scarring"></div>
        </fieldset>
        <fieldset class="group" aria-labelledby="layer-legend">
          <legend id="layer-legend">Layering / cover‑up</legend>
          <div class="options" id="layering"></div>
        </fieldset>
        <div class="toolbar">
          <button class="ghost" type="button" id="resetBtn">Reset</button>
          <button type="button" id="shareBtn">Copy link</button>
        </div>
      </div>
    </section>

    <aside class="card" aria-live="polite" aria-atomic="true">
      <div class="score" id="results">
        <div class="pill">
          <div>Total Kirby–Desai score</div>
          <div class="big" id="total">0</div>
          <span class="badge good" id="flag">Straightforward</span>
        </div>
        <div class="grid2">
          <div class="pill">
            <div>Estimated sessions</div>
            <div class="big" id="sessions">0</div>
          </div>
          <div class="pill">
            <div>Interval</div>
            <div class="big" id="interval">6–8 wks</div>
          </div>
        </div>
        <details>
          <summary>About this estimate</summary>
          <p class="hint">Score ≈ number of sessions at 6–8 week intervals with Q‑switched lasers. Scores >15 suggest more difficult removal. Results vary with device and aftercare.</p>
        </details>
        <div class="footer">
          <small>Educational use only. Consult a clinician for individualized care.</small>
        </div>
      </div>
    </aside>
  </main>

  <script>
    const DATA = {
      skin: [
        { label: "Type I – always burns, never tans", points: 1 },
        { label: "Type II – usually burns, tans with difficulty", points: 2 },
        { label: "Type III – sometimes mild burn, gradually tans", points: 3 },
        { label: "Type IV – rarely burns, tans easily", points: 4 },
        { label: "Type V – very rarely burns, tans very easily", points: 5 },
        { label: "Type VI – never burns, tans very easily", points: 6 },
      ],
      location: [
        { label: "Head & neck", points: 1 },
        { label: "Upper trunk", points: 2 },
        { label: "Lower trunk", points: 3 },
        { label: "Proximal extremity", points: 4 },
        { label: "Distal extremity", points: 5 },
      ],
      colors: [
        { label: "Black only", points: 1 },
        { label: "Mostly black with some red", points: 2 },
        { label: "Black + red + other colors", points: 3 },
        { label: "Multiple colors (non‑black significant)", points: 4 },
      ],
      ink: [
        { label: "Amateur", points: 1 },
        { label: "Minimal", points: 2 },
        { label: "Moderate", points: 3 },
        { label: "Significant", points: 4 },
      ],
      scarring: [
        { label: "No scarring", points: 0 },
        { label: "Minimal", points: 1 },
        { label: "Moderate", points: 3 },
        { label: "Significant", points: 5 },
      ],
      layering: [
        { label: "No", points: 0 },
        { label: "Yes (cover‑up)", points: 2 },
      ],
    };

    function renderGroup(containerId, name, items) {
      const el = document.getElementById(containerId);
      items.forEach((opt, idx) => {
        const id = `${name}-${idx}`;
        const label = document.createElement('label');
        label.className = 'opt';
        label.setAttribute('for', id);
        label.innerHTML = `<input type="radio" name="${name}" id="${id}" value="${opt.points}" ${idx===0? 'checked':''}> <span>${opt.label}</span> <span class="points">${opt.points}</span>`;
        el.appendChild(label);
      });
    }

    renderGroup('skin', 'skin', DATA.skin);
    renderGroup('location', 'location', DATA.location);
    renderGroup('colors', 'colors', DATA.colors);
    renderGroup('ink', 'ink', DATA.ink);
    renderGroup('scarring', 'scarring', DATA.scarring);
    renderGroup('layering', 'layering', DATA.layering);

    const resultsEl = {
      total: document.getElementById('total'),
      sessions: document.getElementById('sessions'),
      flag: document.getElementById('flag'),
    };

    function getValue(name){
      const checked = document.querySelector(`input[name="${name}"]:checked`);
      return checked ? Number(checked.value) : 0;
    }

    function updateResults(){
      const sum = getValue('skin') + getValue('location') + getValue('colors') + getValue('ink') + getValue('scarring') + getValue('layering');
      resultsEl.total.textContent = sum;
      resultsEl.sessions.textContent = sum;
      let cls = 'good', text = 'Straightforward';
      if (sum >= 12 && sum <= 15){ cls = 'warn'; text = 'Challenging'; }
      if (sum > 15){ cls = 'bad'; text = 'Difficult'; }
      resultsEl.flag.className = `badge ${cls}`;
      resultsEl.flag.textContent = text;
      const state = ['skin','location','colors','ink','scarring','layering'].map(getValue);
      history.replaceState(null, '', `#${state.join(',')}`);
    }

    document.getElementById('form').addEventListener('change', updateResults);

    document.getElementById('resetBtn').addEventListener('click', () => {
      ['skin','location','colors','ink','scarring','layering'].forEach(group => {
        const first = document.querySelector(`input[name="${group}"]`);
        if (first) first.checked = true;
      });
      updateResults();
    });

    document.getElementById('shareBtn').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(window.location.href);
        const btn = document.getElementById('shareBtn');
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        setTimeout(()=> btn.textContent = old, 1200);
      } catch {}
    });

    function loadFromHash(){
      const hash = location.hash.slice(1);
      if (!hash) return;
      const parts = hash.split(',').map(n => Number(n));
      const names = ['skin','location','colors','ink','scarring','layering'];
      names.forEach((name, i) => {
        if (!Number.isFinite(parts[i])) return;
        const input = Array.from(document.querySelectorAll(`input[name="${name}"]`)).find(r => Number(r.value) === parts[i]);
        if (input) input.checked = true;
      });
    }

    loadFromHash();
    updateResults();
  </script>
</body>
</html>
